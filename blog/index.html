<!DOCTYPE html>
<html lang="zh-Hant" data-theme="auto">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Blog｜Chien-Hao Huang</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/style.css" />
  <script defer src="/assets/main.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <header class="site-header">
    <a class="brand" href="/">Chien-Hao Huang</a>
    <nav class="nav">
      <a href="/">Home</a>
      <a href="/blog/" aria-current="page">Blog</a>
      <a href="/about/">About</a>
      <button id="theme-toggle" class="theme-toggle" aria-label="Toggle theme" title="切換主題">🌓</button>
    </nav>
  </header>

  <main class="container">
    <h1>Blog</h1>
    <section id="post-list" class="post-feed"></section>
  </main>

  <footer class="site-footer">
    <p>© 2025 Chien-Hao Huang · Hosted on GitHub Pages</p>
  </footer>

  <script>
    // 在這裡列出你的文章資料夾名稱（之後新增文章時只要 push 新資料夾並把 slug 加進來）
    const slugs = ["shp-intro"];

    async function loadPost(slug) {
      const resp = await fetch(`/posts/${slug}/content.md`);
      if (!resp.ok) return null;

      let md = await resp.text();
      const meta = {};
      // 支援最簡 front-matter（只用到 date）
      if (md.startsWith('---')) {
        const end = md.indexOf('\n---');
        if (end !== -1) {
          const fm = md.slice(3, end).trim();
          fm.split('\n').forEach(line => {
            const i = line.indexOf(':');
            if (i > -1) meta[line.slice(0,i).trim()] = line.slice(i+1).trim();
          });
          md = md.slice(end + 4);
        }
      }

      const html = marked.parse(md);
      const tmp = document.createElement('div');
      tmp.innerHTML = html;

      const title   = tmp.querySelector('h1')?.textContent?.trim() || slug;
      const excerpt = tmp.querySelector('p')?.textContent?.trim() || '';
      const img     = tmp.querySelector('img')?.getAttribute('src') || '';
      const date    = meta.date || '';

      return { slug, title, excerpt, img, date };
    }

    (async () => {
      const feed = document.getElementById('post-list');
      for (const slug of slugs) {
        const p = await loadPost(slug);
        if (!p) continue;

        const dateStr = p.date ? `<div class="meta">${p.date}</div>` : '';
        const imgHtml = p.img
          ? `<a href="/posts/${p.slug}/" aria-label="${p.title}"><img class="post-thumb" src="${p.img}" alt="${p.title}"></a>`
          : '<div></div>';

        feed.insertAdjacentHTML('beforeend', `
          <article class="post-card">
            <div>
              <a href="/posts/${p.slug}/" class="post-title-link"><h3>${p.title}</h3></a>
              ${dateStr}
              <p class="excerpt">${p.excerpt}</p>
            </div>
            ${imgHtml}
          </article>
        `);
      }
    })();
  </script>
</body>
</html>
